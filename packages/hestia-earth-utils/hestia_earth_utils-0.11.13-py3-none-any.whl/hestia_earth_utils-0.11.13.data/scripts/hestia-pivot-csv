#!python

import sys
import argparse
from hestia_earth.utils.table import pivot_csv, pivot_hestia_file


parser = argparse.ArgumentParser(description='Pivot nodes in CSV format.')
parser.add_argument('--input-file', type=str, required=True,
                    help='The path of the CSV or JSON file.')
parser.add_argument('--output-file', type=str,
                    help='The path of where to store the pivoted CSV. Adds "-pivoted" suffix by default to input.')
args = parser.parse_args()


def main():
    src = args.input_file
    dest = args.output_file or src.split('.')[0] + '-pivoted.csv'
    pd = pivot_csv(src) if src.endswith('.csv') else pivot_hestia_file(open(src, 'r').read())
    pd.to_csv(dest, index=None)


if __name__ == '__main__':
    sys.exit(main())
