"use strict";(self.webpackChunkjupyterlab_celltagsclasses=self.webpackChunkjupyterlab_celltagsclasses||[]).push([[68],{68:(e,t,n)=>{n.r(t),n.d(t,{Scope:()=>M,apply_on_cells:()=>w,default:()=>_,md_clean:()=>b,md_get:()=>u,md_has:()=>m,md_insert:()=>v,md_remove:()=>h,md_set:()=>f,md_toggle:()=>p,md_toggle_multi:()=>y,md_unset:()=>g});var s,o=n(809),a=n(272);!function(e){e[e.Get=0]="Get",e[e.Set=1]="Set",e[e.Unset=2]="Unset",e[e.Insert=3]="Insert",e[e.Remove=4]="Remove"}(s||(s={}));const l=e=>{if("string"==typeof e){const t=e;return 0===t.length?[]:t.split(".")}return e instanceof Array?e:(console.error(`xpath must be string or array, got ${e}`),[])},r=(e,t,n,o)=>{const{Get:a,Set:r,Unset:c,Insert:i,Remove:d}=s,u=(e,t,n,s)=>{if(0===n.length)return t===a?e:void 0;if(1===n.length){const[o]=n;switch(t){case a:return e[o];case r:return e[o]=s,s;case c:return o in e&&(delete e[o],!0);case i:if(o in e||(e[o]=[]),!(e[o]instanceof Array))return;{const t=e[o];return t.indexOf(s)<0?(t.push(s),s):void 0}case d:if(!(e[o]instanceof Array))return;const t=e[o],n=t.indexOf(s);return n>=0&&t.splice(n,1),s}}else{const[o,...l]=n;if(o in e){if(e[o]instanceof Object){const n=e[o];return u(n,t,l,s)}return}switch(t){case a:return;case r:e[o]={};const n=e[o];return u(n,t,l,s);case c:return;case i:return 0===l.length?(e[o]=[],u(e[o],t,l,s)):(e[o]={},u(e[o],t,l,s));case d:return}}},f=l(n);return u(e,t,f,o)},c=(e,t)=>r(e,s.Get,t,void 0),i=(e,t,n)=>r(e,s.Set,t,n),d=(e,t)=>((e,t)=>{const n=e=>e instanceof Array?0!==e.length:e instanceof Object?0!==Object.keys(e).length:"string"!=typeof e||0!==e.length,s=e=>e instanceof Array?(e=>e.map(s).filter(n))(e):e instanceof Object?(e=>{const t={};for(const o in e){const a=e[o],l=s(a);n(l)&&(t[o]=l)}return t})(e):e,o=l(t);if(0===o.length)return s(e);{const t=c(e,o);return void 0===t?e:i(e,o,s(t))}})(e,t),u=(e,t,n)=>{e instanceof a.Cell&&(e=e.model),t=l(t);const[s,...o]=t,r=e.getMetadata(s);return void 0===r?n:c(r,o)},f=(e,t,n)=>{t=l(t);const[s,...o]=t,a=e.model.getMetadata(s);if(0===o.length)return e.model.setMetadata(s,n),n;const r=a||{},c=i(r,o,n);return e.model.setMetadata(s,r),c},g=(e,t)=>{t=l(t);const[n,...o]=t,a=e.model.getMetadata(n);if(void 0===a)return!1;if(0===o.length)return e.model.deleteMetadata(n),!0;{const t=((e,t)=>r(e,s.Unset,t,void 0))(a,o);return e.model.setMetadata(n,a),t}},m=(e,t,n)=>{t=l(t);const[s,...o]=t,a=e.model.getMetadata(s);if(void 0===a)return!1;const r=c(a,o);return void 0!==r&&r.indexOf(n)>=0},v=(e,t,n)=>{t=l(t);const[o,...a]=t,c=e.model.getMetadata(o);if(0===a.length){let t;return void 0!==c?(t=c,t=t.slice()):t=[],t.indexOf(n)<0?(t.push(n),e.model.setMetadata(o,t),n):void 0}{const t=c||{},l=((e,t,n)=>r(e,s.Insert,t,n))(t,a,n);return e.model.setMetadata(o,t),l}},h=(e,t,n)=>{t=l(t);const[o,...a]=t,c=e.model.getMetadata(o);if(void 0!==c){if(0===a.length){if(!(c instanceof Array))return;const t=c.slice(),s=t.indexOf(n);if(s<0)return;return t.splice(s,1),e.model.setMetadata(o,t),n}{const t=c,l=((e,t,n)=>r(e,s.Remove,t,n))(t,a,n);return e.model.setMetadata(o,t),l}}},p=(e,t,n)=>(t=l(t),m(e,t,n)?h(e,t,n):v(e,t,n)),y=(e,t,n,s)=>{s.includes(n)&&p(e,t,n);for(const o of s)o!==n&&h(e,t,o)},b=(e,t)=>{t=l(t);const[n,...s]=t;if(void 0===n){console.log(e.model.metadata);for(const t of Object.entries(e.model.metadata)){const n=t,s=d(u(e,n),"");void 0===s||0===s.length?g(e,n):f(e,n,s)}}else{const t=u(e,n),o=d(t,s);void 0===o||0===o.length?g(e,n):f(e,n,o)}};var M;!function(e){e[e.All=0]="All",e[e.Active=1]="Active",e[e.Multiple=2]="Multiple"}(M||(M={}));const w=(e,t,n)=>{var s;const o=null===(s=e.currentWidget)||void 0===s?void 0:s.content;if(void 0===o)return;let a;if(t===M.All)a=o.widgets.slice();else{const e=o.activeCell;if(null===e)return;if(t===M.Active)a=[e];else{const{anchor:t,head:n}=o.getContiguousSelection();a=null===t||null===n?[e]:o.widgets.slice(t,n+1)}}a.forEach(n)},_={id:"jupyterlab-celltagsclasses:plugin",autoStart:!0,requires:[o.INotebookTracker],activate:(e,t)=>{console.log("extension jupyterlab-celltagsclasses is activating");const n=e=>`cell-tag-${e}`;t.widgetAdded.connect(((e,t)=>{const s=t.content.model;null!==s&&s.cells.changed.connect(((e,s)=>{"add"===s.type&&s.newValues.forEach((e=>{var s;const o=t.content.widgets.filter(((t,n)=>t.model.id===e.id));void 0!==o&&0!==(null==o?void 0:o.length)&&(null===(s=e.getMetadata("tags"))||void 0===s||s.forEach((e=>null==o?void 0:o.forEach((t=>{t.addClass(n(e))})))),e.metadataChanged.connect(((e,t)=>{if("tags"===t.key)if("change"===t.type){const e=t.oldValue,s=t.newValue,a=s.filter((t=>!e.includes(t))),l=e.filter((e=>!s.includes(e)));o.forEach((e=>{a.forEach((t=>{console.debug(`adding class for tag ${n(t)}`),e.addClass(n(t))})),l.forEach((t=>{console.debug(`removing class for tag ${n(t)}`),e.removeClass(n(t))}))}))}else"add"===t.type?(console.debug("celltagsclasses: add",t,t.newValue),o.forEach((e=>{for(const s of t.newValue)e.addClass(n(s))}))):"remove"===t.type&&(console.debug("celltagsclasses: remove",t,t.newValue),o.forEach((e=>{for(const s of t.newValue)e.removeClass(n(s))})))})))}))}))}))}}}}]);