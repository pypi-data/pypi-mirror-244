"use strict";(self.webpackChunkjupyterlab_pioneer=self.webpackChunkjupyterlab_pioneer||[]).push([[462],{462:(e,n,t)=>{t.r(n),t.d(n,{IJupyterLabPioneer:()=>C,default:()=>S});var o=t(122),i=t(930),l=t(749),d=t(125);async function a(e="",n={}){const t=d.ServerConnection.makeSettings(),o=l.URLExt.join(t.baseUrl,"jupyterlab-pioneer",e);let i;try{i=await d.ServerConnection.makeRequest(o,n,t)}catch(e){throw new d.ServerConnection.NetworkError(e)}let a=await i.text();if(a.length>0)try{a=JSON.parse(a)}catch(e){console.log("Not a JSON response body.",i)}if(!i.ok)throw new d.ServerConnection.ResponseError(i,a.message||a);return a}var v=t(211);class s{listen(e,n,t){e.content.activeCellChanged.connect((async(o,i)=>{var l,d;if(i&&e.content.widgets){const o={id:null==i?void 0:i.model.id,index:e.content.widgets.findIndex((e=>e===i))},a={eventName:s.id,eventTime:Date.now(),eventInfo:{cells:[o]}};await n.publishEvent(e,a,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==s.id)))||void 0===d?void 0:d.logWholeNotebook)}}))}}s.id="ActiveCellChangeEvent";class c{listen(e,n,t){var o;null===(o=e.content.model)||void 0===o||o.cells.changed.connect((async(o,i)=>{var l,d;if("add"===i.type){const o={id:i.newValues[0].id,index:i.newIndex},a={eventName:c.id,eventTime:Date.now(),eventInfo:{cells:[o]}};await n.publishEvent(e,a,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==c.id)))||void 0===d?void 0:d.logWholeNotebook)}}))}}c.id="CellAddEvent";class r{listen(e,n,t){var o,i;const l=async(o,i)=>{var l,d,a,v;await(null==i?void 0:i.ready);const s=null==i?void 0:i.editor,c={eventName:r.id,eventTime:Date.now(),eventInfo:{index:e.content.widgets.findIndex((e=>e===i)),doc:null===(d=null===(l=null==s?void 0:s.state)||void 0===l?void 0:l.doc)||void 0===d?void 0:d.toJSON()}};await n.publishEvent(e,c,t,null===(v=null===(a=t.activeEvents)||void 0===a?void 0:a.find((e=>e.name==r.id)))||void 0===v?void 0:v.logWholeNotebook)},d=async o=>{await(null==o?void 0:o.ready);const i=null==o?void 0:o.editor;null==i||i.injectExtension(v.EditorView.updateListener.of((async i=>{if(i.docChanged){const l={eventName:r.id,eventTime:Date.now(),eventInfo:{index:e.content.widgets.findIndex((e=>e===o)),changes:i.changes.toJSON()}};await n.publishEvent(e,l,t,!1)}})))};null===(o=null==e?void 0:e.content)||void 0===o||o.widgets.forEach((e=>{d(e)})),l(e.content,e.content.activeCell),null===(i=e.content.model)||void 0===i||i.cells.changed.connect((async(n,t)=>{var o;"add"===t.type&&d(null===(o=null==e?void 0:e.content)||void 0===o?void 0:o.widgets[t.newIndex])})),e.content.activeCellChanged.connect(l)}}r.id="CellEditEvent";class u{listen(e,n,t){o.NotebookActions.executed.connect((async(o,i)=>{var l,d;if(e.content===i.notebook){const o={id:i.cell.model.id,index:i.notebook.widgets.findIndex((e=>e==i.cell))},a={eventName:u.id,eventTime:Date.now(),eventInfo:{cells:[o],success:i.success,kernelError:i.success?null:i.error}};await n.publishEvent(e,a,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==u.id)))||void 0===d?void 0:d.logWholeNotebook)}}))}}u.id="CellExecuteEvent";class m{listen(e,n,t){var o;null===(o=e.content.model)||void 0===o||o.cells.changed.connect((async(o,i)=>{var l,d;if("remove"===i.type){const o={index:i.oldIndex},a={eventName:m.id,eventTime:Date.now(),eventInfo:{cells:[o]}};await n.publishEvent(e,a,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==m.id)))||void 0===d?void 0:d.logWholeNotebook)}}))}}m.id="CellRemoveEvent";class w{listen(e,n,t){e.node.addEventListener("copy",(async()=>{var o,i,l,d;const a={id:null===(o=e.content.activeCell)||void 0===o?void 0:o.model.id,index:e.content.widgets.findIndex((n=>n===e.content.activeCell))},v=null===(i=document.getSelection())||void 0===i?void 0:i.toString(),s={eventName:w.id,eventTime:Date.now(),eventInfo:{cells:[a],selection:v}};await n.publishEvent(e,s,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==w.id)))||void 0===d?void 0:d.logWholeNotebook)}))}}w.id="ClipboardCopyEvent";class h{listen(e,n,t){e.node.addEventListener("cut",(async()=>{var o,i,l,d;const a={id:null===(o=e.content.activeCell)||void 0===o?void 0:o.model.id,index:e.content.widgets.findIndex((n=>n===e.content.activeCell))},v=null===(i=document.getSelection())||void 0===i?void 0:i.toString(),s={eventName:h.id,eventTime:Date.now(),eventInfo:{cells:[a],selection:v}};await n.publishEvent(e,s,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==h.id)))||void 0===d?void 0:d.logWholeNotebook)}))}}h.id="ClipboardCutEvent";class E{listen(e,n,t){e.node.addEventListener("paste",(async o=>{var i,l,d;const a={id:null===(i=e.content.activeCell)||void 0===i?void 0:i.model.id,index:e.content.widgets.findIndex((n=>n===e.content.activeCell))},v=(o.clipboardData||window.clipboardData).getData("text"),s={eventName:E.id,eventTime:Date.now(),eventInfo:{cells:[a],selection:v}};await n.publishEvent(e,s,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==E.id)))||void 0===d?void 0:d.logWholeNotebook)}))}}E.id="ClipboardPasteEvent";class f{listen(e,n,t){document.addEventListener("visibilitychange",(async o=>{var i,l;if("hidden"===document.visibilityState&&document.contains(e.node)){const o={eventName:f.id,eventTime:Date.now(),eventInfo:null};await n.publishEvent(e,o,t,null===(l=null===(i=t.activeEvents)||void 0===i?void 0:i.find((e=>e.name==f.id)))||void 0===l?void 0:l.logWholeNotebook)}}))}}f.id="NotebookHiddenEvent";class p{constructor(){this.produced=!1}async listen(e,n,t){var o,i;if(!this.produced){const l={eventName:p.id,eventTime:Date.now(),eventInfo:{environ:await a("environ")}};await n.publishEvent(e,l,t,null===(i=null===(o=t.activeEvents)||void 0===o?void 0:o.find((e=>e.name==p.id)))||void 0===i?void 0:i.logWholeNotebook),this.produced=!0}}}p.id="NotebookOpenEvent";class b{listen(e,n,t){e.context.saveState.connect((async(o,i)=>{var l,d;if(i.match("completed")){const o={eventName:b.id,eventTime:Date.now(),eventInfo:null};await n.publishEvent(e,o,t,null===(d=null===(l=t.activeEvents)||void 0===l?void 0:l.find((e=>e.name==b.id)))||void 0===d?void 0:d.logWholeNotebook)}}))}}b.id="NotebookSaveEvent";const g=e=>{const n=[];for(let t=0;t<e.content.widgets.length;t++){const o=e.content.widgets[t],i=o.node.offsetTop,l=o.node.offsetTop+o.node.offsetHeight,d=e.content.node.scrollTop;i<=e.content.node.scrollTop+e.content.node.clientHeight&&l>=d&&n.push({id:o.model.id,index:t})}return n};class y{constructor(){this.timeout=0}listen(e,n,t){e.content.node.addEventListener("scroll",(async o=>{var i,l;o.stopPropagation(),clearTimeout(this.timeout),await new Promise((e=>this.timeout=window.setTimeout(e,1500)));const d={eventName:y.id,eventTime:Date.now(),eventInfo:{cells:g(e)}};await n.publishEvent(e,d,t,null===(l=null===(i=t.activeEvents)||void 0===i?void 0:i.find((e=>e.name==y.id)))||void 0===l?void 0:l.logWholeNotebook)}))}}y.id="NotebookScrollEvent";class N{listen(e,n,t){document.addEventListener("visibilitychange",(async()=>{var o,i;if("visible"===document.visibilityState&&document.contains(e.node)){const l={eventName:N.id,eventTime:Date.now(),eventInfo:{cells:g(e)}};await n.publishEvent(e,l,t,null===(i=null===(o=t.activeEvents)||void 0===o?void 0:o.find((e=>e.name==N.id)))||void 0===i?void 0:i.logWholeNotebook)}}))}}N.id="NotebookVisibleEvent";const k=[s,c,u,m,r,w,h,E,f,p,b,y,N],x="jupyterlab-pioneer:plugin",C=new i.Token(x);class I{async publishEvent(e,n,t,o){var i,l;if(!e)throw Error("router is listening to a null notebook panel");const d={eventDetail:n,notebookState:{sessionID:null===(i=null==e?void 0:e.sessionContext.session)||void 0===i?void 0:i.id,notebookPath:null==e?void 0:e.context.path,notebookContent:o?null===(l=null==e?void 0:e.model)||void 0===l?void 0:l.toJSON():null},exporter:t},v=await a("export",{method:"POST",body:JSON.stringify(d)});console.log(v)}}const S={id:x,autoStart:!0,requires:[o.INotebookTracker],provides:C,activate:async(e,n)=>{const t=await a("version");console.log(`${x}: ${t}`);const o=await a("config"),i=new I;return n.widgetAdded.connect((async(e,n)=>{var t;await n.revealed,await n.sessionContext.ready;const l=o.activeEvents,d=(null===(t=n.content.model)||void 0===t?void 0:t.getMetadata("exporters"))||o.exporters,a=l&&l.length?d.map((e=>(e.activeEvents||(e.activeEvents=l),e))):d.filter((e=>e.activeEvents&&e.activeEvents.length));console.log(a),a.forEach((e=>{k.forEach((t=>{var o;(null===(o=e.activeEvents)||void 0===o?void 0:o.map((e=>e.name)).includes(t.id))&&(new t).listen(n,i,e)}))}))})),i}}}}]);