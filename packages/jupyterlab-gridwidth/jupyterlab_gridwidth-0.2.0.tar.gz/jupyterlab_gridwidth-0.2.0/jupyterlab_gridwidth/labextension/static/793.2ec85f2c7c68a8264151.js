"use strict";(self.webpackChunkjupyterlab_gridwidth=self.webpackChunkjupyterlab_gridwidth||[]).push([[793],{793:(e,t,n)=>{n.r(t),n.d(t,{Scope:()=>M,apply_on_cells:()=>w,default:()=>_,md_clean:()=>b,md_get:()=>u,md_has:()=>v,md_insert:()=>m,md_remove:()=>h,md_set:()=>f,md_toggle:()=>p,md_toggle_multi:()=>y,md_unset:()=>g});var o,s=n(122),a=n(714);!function(e){e[e.Get=0]="Get",e[e.Set=1]="Set",e[e.Unset=2]="Unset",e[e.Insert=3]="Insert",e[e.Remove=4]="Remove"}(o||(o={}));const r=e=>{if("string"==typeof e){const t=e;return 0===t.length?[]:t.split(".")}return e instanceof Array?e:(console.error(`xpath must be string or array, got ${e}`),[])},l=(e,t,n,s)=>{const{Get:a,Set:l,Unset:c,Insert:i,Remove:d}=o,u=(e,t,n,o)=>{if(0===n.length)return t===a?e:void 0;if(1===n.length){const[s]=n;switch(t){case a:return e[s];case l:return e[s]=o,o;case c:return s in e&&(delete e[s],!0);case i:if(s in e||(e[s]=[]),!(e[s]instanceof Array))return;{const t=e[s];return t.indexOf(o)<0?(t.push(o),o):void 0}case d:if(!(e[s]instanceof Array))return;const t=e[s],n=t.indexOf(o);return n>=0&&t.splice(n,1),o}}else{const[s,...r]=n;if(s in e){if(e[s]instanceof Object){const n=e[s];return u(n,t,r,o)}return}switch(t){case a:return;case l:e[s]={};const n=e[s];return u(n,t,r,o);case c:return;case i:return 0===r.length?(e[s]=[],u(e[s],t,r,o)):(e[s]={},u(e[s],t,r,o));case d:return}}},f=r(n);return u(e,t,f,s)},c=(e,t)=>l(e,o.Get,t,void 0),i=(e,t,n)=>l(e,o.Set,t,n),d=(e,t)=>((e,t)=>{const n=e=>e instanceof Array?0!==e.length:e instanceof Object?0!==Object.keys(e).length:"string"!=typeof e||0!==e.length,o=e=>e instanceof Array?(e=>e.map(o).filter(n))(e):e instanceof Object?(e=>{const t={};for(const s in e){const a=e[s],r=o(a);n(r)&&(t[s]=r)}return t})(e):e,s=r(t);if(0===s.length)return o(e);{const t=c(e,s);return void 0===t?e:i(e,s,o(t))}})(e,t),u=(e,t,n)=>{e instanceof a.Cell&&(e=e.model),t=r(t);const[o,...s]=t,l=e.getMetadata(o);return void 0===l?n:c(l,s)},f=(e,t,n)=>{t=r(t);const[o,...s]=t,a=e.model.getMetadata(o);if(0===s.length)return e.model.setMetadata(o,n),n;const l=a||{},c=i(l,s,n);return e.model.setMetadata(o,l),c},g=(e,t)=>{t=r(t);const[n,...s]=t,a=e.model.getMetadata(n);if(void 0===a)return!1;if(0===s.length)return e.model.deleteMetadata(n),!0;{const t=((e,t)=>l(e,o.Unset,t,void 0))(a,s);return e.model.setMetadata(n,a),t}},v=(e,t,n)=>{t=r(t);const[o,...s]=t,a=e.model.getMetadata(o);if(void 0===a)return!1;const l=c(a,s);return void 0!==l&&l.indexOf(n)>=0},m=(e,t,n)=>{t=r(t);const[s,...a]=t,c=e.model.getMetadata(s);if(0===a.length){let t;return void 0!==c?(t=c,t=t.slice()):t=[],t.indexOf(n)<0?(t.push(n),e.model.setMetadata(s,t),n):void 0}{const t=c||{},r=((e,t,n)=>l(e,o.Insert,t,n))(t,a,n);return e.model.setMetadata(s,t),r}},h=(e,t,n)=>{t=r(t);const[s,...a]=t,c=e.model.getMetadata(s);if(void 0!==c){if(0===a.length){if(!(c instanceof Array))return;const t=c.slice(),o=t.indexOf(n);if(o<0)return;return t.splice(o,1),e.model.setMetadata(s,t),n}{const t=c,r=((e,t,n)=>l(e,o.Remove,t,n))(t,a,n);return e.model.setMetadata(s,t),r}}},p=(e,t,n)=>(t=r(t),v(e,t,n)?h(e,t,n):m(e,t,n)),y=(e,t,n,o)=>{o.includes(n)&&p(e,t,n);for(const s of o)s!==n&&h(e,t,s)},b=(e,t)=>{t=r(t);const[n,...o]=t;if(void 0===n){console.log(e.model.metadata);for(const t of Object.entries(e.model.metadata)){const n=t,o=d(u(e,n),"");void 0===o||0===o.length?g(e,n):f(e,n,o)}}else{const t=u(e,n),s=d(t,o);void 0===s||0===s.length?g(e,n):f(e,n,s)}};var M;!function(e){e[e.All=0]="All",e[e.Active=1]="Active",e[e.Multiple=2]="Multiple"}(M||(M={}));const w=(e,t,n)=>{var o;const s=null===(o=e.currentWidget)||void 0===o?void 0:o.content;if(void 0===s)return;let a;if(t===M.All)a=s.widgets.slice();else{const e=s.activeCell;if(null===e)return;if(t===M.Active)a=[e];else{const{anchor:t,head:n}=s.getContiguousSelection();a=null===t||null===n?[e]:s.widgets.slice(t,n+1)}}a.forEach(n)},_={id:"jupyterlab-celltagsclasses:plugin",autoStart:!0,requires:[s.INotebookTracker],activate:(e,t)=>{console.log("extension jupyterlab-celltagsclasses is activating");const n=e=>`cell-tag-${e}`;t.widgetAdded.connect(((e,o)=>{const s=o.content.model;null!==s&&s.cells.changed.connect(((e,o)=>{"add"===o.type&&o.newValues.forEach((e=>{var o,s;const a=null===(o=t.currentWidget)||void 0===o?void 0:o.content.widgets.filter(((t,n)=>t.model.id===e.id));void 0!==a&&0!==(null==a?void 0:a.length)&&(null===(s=e.getMetadata("tags"))||void 0===s||s.forEach((e=>null==a?void 0:a.forEach((t=>{t.addClass(n(e))})))),e.metadataChanged.connect(((e,t)=>{if("tags"===t.key)if("change"===t.type){const e=t.oldValue,o=t.newValue,s=o.filter((t=>!e.includes(t))),r=e.filter((e=>!o.includes(e)));a.forEach((e=>{s.forEach((t=>{console.debug(`adding class for tag ${n(t)}`),e.addClass(n(t))})),r.forEach((t=>{console.debug(`removing class for tag ${n(t)}`),e.removeClass(n(t))}))}))}else"add"===t.type?(console.debug("celltagsclasses: add",t,t.newValue),a.forEach((e=>{for(const o of t.newValue)e.addClass(n(o))}))):"remove"===t.type&&(console.debug("celltagsclasses: remove",t,t.newValue),a.forEach((e=>{for(const o of t.newValue)e.removeClass(n(o))})))})))}))}))}))}}}}]);